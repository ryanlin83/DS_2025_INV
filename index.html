<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>å–®å“ç·¨è™ŸæŸ¥è©¢ç³»çµ±</title>
<style>
  body { font-family: Arial, sans-serif; padding: 16px; background:#f5f6fa; }
  h2 { margin-bottom: 14px; font-size:20px; }

  /* æ‰‹æ©Ÿå‹å–„è¼¸å…¥æ¡†å€å¡Š */
  .input-box {
    display:flex;
    flex-direction:column;
    gap:10px;
    margin-bottom:16px;
  }

  input {
    padding: 12px;
    width: 100%;
    font-size:16px;
    border:1px solid #ccc;
    border-radius:8px;
  }

  button {
    padding: 12px;
    width:100%;
    margin-top:4px;
    background:#2563eb;
    color:white;
    border:0;
    border-radius:8px;
    font-size:16px;
    cursor:pointer;
  }

  #status { margin-top:12px; color:#555; font-size:14px; }

  /* è¡¨æ ¼æ‰‹æ©Ÿç‰ˆæ¡å¡ç‰‡å¼æ¨£ */
  table { width: 100%; border-collapse: collapse; margin-top: 20px; display:none; }
  thead { display:none; }
  tbody tr { background:white; padding:14px; border-radius:10px; margin-bottom:12px; display:block; box-shadow:0 2px 5px rgba(0,0,0,0.06); }
  td { display:flex; justify-content:space-between; padding:6px 4px; border:0; font-size:15px; }
  td::before{ content:attr(data-label); font-weight:600; color:#444; }

  @media (min-width:700px) {
    body { padding: 30px; }

    .input-box { flex-direction:row; align-items:center; gap:10px; }
    input { width:260px; }
    button { width:auto; padding:10px 16px; }

    table { display:table; }
    thead { display:table-header-group; }
    tbody tr { display:table-row; box-shadow:none; border-bottom:1px solid #ddd; border-radius:0; }
    td { display:table-cell; padding:10px; }
    td::before { display:none; }
  }
</style>
</head>
<body>

<h2>ğŸ“¦ å–®å“ç·¨è™ŸæŸ¥è©¢ç³»çµ±</h2>

<div class="input-box">
  <input id="inputCode" placeholder="ä¾‹å¦‚ï¼šA12345" />
  <button onclick="searchItem()">æŸ¥è©¢</button>
</div>

<div id="status">è³‡æ–™è¼‰å…¥ä¸­â€¦</div>

<table id="resultTable">
  <thead>
    <tr>
      <th>å•†å“åç¨±</th>
      <th>ç›¤é»è²¨æ¶ç·¨è™Ÿ</th>
      <th>ç›¤é»ä½ç½®</th>
      <th>ç›¤é»æ•¸é‡</th>
    </tr>
  </thead>
  <tbody id="resultBody"></tbody>
</table>

<script>
// ä½¿ç”¨æ–°çš„å·¥ä½œè¡¨åç¨± "P4è³‡æ–™åº«"
const SHEET_URL = "https://docs.google.com/spreadsheets/d/1jkc2FzmhLhj9mtqsyVRosECGRlRUURjZlaGK_auhpMM/gviz/tq?tqx=out:csv&sheet=P4è³‡æ–™åº«";

let sheetData = [];

fetch(SHEET_URL)
  .then(res => res.text())
  .then(csv => {
    let rows = csv.trim().split("\n").map(r => r.split(","));
    rows.shift(); // ç§»é™¤æ¨™é¡Œåˆ—
    sheetData = rows;
    document.getElementById("status").innerText = "è³‡æ–™è¼‰å…¥å®Œæˆï¼Œå¯é–‹å§‹æŸ¥è©¢ã€‚";
  })
  .catch(err => {
    document.getElementById("status").innerText = "è³‡æ–™è¼‰å…¥éŒ¯èª¤ï¼š" + err;
  });

function searchItem() {
  const code = document.getElementById("inputCode").value.trim();
  const tbody = document.getElementById("resultBody");
  const table = document.getElementById("resultTable");

  tbody.innerHTML = "";
  table.style.display = "none";

  if (!code) {
    document.getElementById("status").innerText = "è«‹è¼¸å…¥å–®å“ç·¨è™Ÿã€‚";
    return;
  }

  const matches = sheetData.filter(row => row[0] === code);

  if (matches.length === 0) {
    document.getElementById("status").innerText = "æŸ¥ç„¡è³‡æ–™ï¼";
    return;
  }

  matches.forEach(row => {
    let tr = document.createElement("tr");
    tr.innerHTML = `
      <td data-label="å•†å“åç¨±">${row[1] || ""}</td>
      <td data-label="è²¨æ¶ç·¨è™Ÿ">${row[2] || ""}</td>
      <td data-label="ç›¤é»ä½ç½®">${row[3] || ""}</td>
      <td data-label="æ•¸é‡">${row[4] || ""}</td>
    `;
    tbody.appendChild(tr);
  });

  table.style.display = "block";
  document.getElementById("status").innerText = `å…± ${matches.length} ç­†ç¬¦åˆçš„è³‡æ–™ã€‚`;
}
</script>

</body>
</html>
