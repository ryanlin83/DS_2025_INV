<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>ç›¤é»ä½ç½®æŸ¥è©¢</title>
<style>
  body { font-family: Arial, sans-serif; padding: 16px; background:#f5f6fa; margin:0; }
  h1 { font-size:28px; text-align:center; margin-bottom:8px; color:#2563eb; }
  h2 { margin-bottom: 16px; font-size:22px; text-align:center; }

  /* è¼¸å…¥å€å¡Š */
  .input-box {
    display:flex;
    flex-direction:column;
    gap:10px;
    margin-bottom:16px;
  }

  input {
    padding: 14px;
    width: 100%;
    font-size:18px;
    border:2px solid #2563eb;
    border-radius:10px;
    box-sizing:border-box;
  }

  button {
    padding: 14px;
    width:100%;
    background:#2563eb;
    color:white;
    border:0;
    border-radius:10px;
    font-size:18px;
    cursor:pointer;
  }

  #status { margin-top:12px; color:#2563eb; font-size:16px; text-align:center; }

  /* è¡¨æ ¼æ¨£å¼ */
  table { width: 100%; border-collapse: collapse; margin-top: 20px; display:none; }
  th, td {
    border: 1px solid #2563eb;
    padding: 12px;
    font-size:16px;
    color:#2563eb;
    text-align:left;
  }
  th { background:#e0f0ff; }

  /* æ‰‹æ©Ÿç‰ˆæ ¼å­å¼ */
  @media (max-width:700px) {
    table, thead, tbody, th, td, tr { display: block; width: 100%; }
    thead { display: none; }
    tr { margin-bottom:12px; border:2px solid #2563eb; border-radius:10px; padding:12px; background:white; }
    td {
      display:flex;
      justify-content:space-between;
      padding:10px;
      border:none;
      border-bottom:1px solid #2563eb;
      font-size:18px;
    }
    td:last-child { border-bottom:none; }
    td::before { content:attr(data-label); font-weight:600; margin-right:5px; width:40%; }
    td span { width:55%; text-align:right; }
  }
</style>
</head>
<body>

<h1>ç›¤é»ä½ç½®æŸ¥è©¢</h1>
<h2>ğŸ“¦ å–®å“ç·¨è™ŸæŸ¥è©¢ç³»çµ±</h2>

<div class="input-box">
  <input id="inputCode" placeholder="ä¾‹å¦‚ï¼šA12345" />
  <button onclick="searchItem()">æŸ¥è©¢</button>
</div>

<div id="status">è³‡æ–™è¼‰å…¥ä¸­â€¦</div>

<table id="resultTable">
  <thead>
    <tr>
      <th>å•†å“åç¨±</th>
      <th>ç›¤é»è²¨æ¶ç·¨è™Ÿ</th>
      <th>ç›¤é»ä½ç½®</th>
      <th>ç›¤é»æ•¸é‡</th>
    </tr>
  </thead>
  <tbody id="resultBody"></tbody>
</table>

<script>
const SHEET_URL = "https://docs.google.com/spreadsheets/d/1jkc2FzmhLhj9mtqsyVRosECGRlRUURjZlaGK_auhpMM/export?format=csv&gid=0";

let sheetData = [];

fetch(SHEET_URL)
  .then(res => res.text())
  .then(csv => {
    let rows = csv.trim().split("\n").map(r => r.split(","));
    rows.shift(); // ç§»é™¤æ¨™é¡Œåˆ—
    sheetData = rows;
    document.getElementById("status").innerText = "è³‡æ–™è¼‰å…¥å®Œæˆï¼Œå¯é–‹å§‹æŸ¥è©¢ã€‚";
  })
  .catch(err => {
    document.getElementById("status").innerText = "è³‡æ–™è¼‰å…¥éŒ¯èª¤ï¼š" + err;
  });

function searchItem() {
  const code = document.getElementById("inputCode").value.trim();
  const tbody = document.getElementById("resultBody");
  const table = document.getElementById("resultTable");

  tbody.innerHTML = "";
  table.style.display = "none";

  if (!code) {
    document.getElementById("status").innerText = "è«‹è¼¸å…¥å–®å“ç·¨è™Ÿã€‚";
    return;
  }

  const matches = sheetData.filter(row => row[0] === code);

  if (matches.length === 0) {
    document.getElementById("status").innerText = "æŸ¥ç„¡è³‡æ–™ï¼";
    return;
  }

  matches.forEach(row => {
    let tr = document.createElement("tr");
    tr.innerHTML = `
      <td data-label="å•†å“åç¨±"><span>${row[1] || ""}</span></td>
      <td data-label="ç›¤é»è²¨æ¶ç·¨è™Ÿ"><span>${row[2] || ""}</span></td>
      <td data-label="ç›¤é»ä½ç½®"><span>${row[3] || ""}</span></td>
      <td data-label="ç›¤é»æ•¸é‡"><span>${row[4] || ""}</span></td>
    `;
    tbody.appendChild(tr);
  });

  table.style.display = "table";
  document.getElementById("status").innerText = `å…± ${matches.length} ç­†ç¬¦åˆçš„è³‡æ–™ã€‚`;
}
</script>

</body>
</html>
